function N_d = basis(d, x, y)
% Initializing Vector of Basis Functions by Hand
N_d = zeros(1,12);

global a;

[ x_1 , y_1 , x_2 , y_2 , mp_x , mp_y] = integration_points( d );

xi = ( x - mp_x ) / a;
eta = ( y - mp_y ) / a;

w_h = [ 1 , xi , eta , xi^2 , xi*eta , eta^2 , xi^3 , xi^2*eta , xi*eta^2 , eta^3 , xi^3*eta , xi*eta^3 ];

A = [ 1 , -1, -1, 1 , 1 , 1 , -1, -1, -1, -1, 1 , 1  ;
      0 , 0 , 1 , 0 , -1, -2, 0 , 1 , 2 , 3 , -1, -3 ;
      0 , -1, 0 , 2 , 1 , 0 , -3, -2, -1, 0 , 3 , 1  ;
      1 , 1 , -1, 1 , -1, 1 , 1 , -1, 1 , -1, -1, -1 ;
      0 , 0 , 1 , 0 , 1 , -2, 0 , 1 , -2, 3 , 1 , 3  ;
      0 , -1, 0 , -2, 1 , 0 , -3, 2 , -1, 0 , 3 , 1  ;
      1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1 , 1  ;
      0 , 0 , 1 , 0 , 1 , 2 , 0 , 1 , 2 , 3 , 1 , 3  ;
      0 , -1, 0 , -2, -1, 0 , -3, -2, -1, 0 , -3, -1 ;
      1 , -1, 1 , 1 , -1, 1 , -1, 1 , -1, 1 , -1, -1 ;
      0 , 0 , 1 , 0 , -1, 2 , 0 , 1 , -2, 3 , -1, -3 ;
      0 , -1, 0 , 2 , -1, 0 , -3, 2 , -1, 0 , -3, -1];

A_inv = inv(A);

N_d = w_h * A_inv;

N_d(2) = a^2 * N_d(2);
N_d(3) = a^2 * N_d(3);
N_d(5) = a^2 * N_d(5);
N_d(6) = a^2 * N_d(6);
N_d(8) = a^2 * N_d(8);
N_d(9) = a^2 * N_d(9);
N_d(11) = a^2 * N_d(11);
N_d(12) = a^2 * N_d(12);

end
      